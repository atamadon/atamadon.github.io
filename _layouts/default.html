<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ page.title }} | {{ site.title }}</title>

  <!-- Favicon -->
  <link
    rel="icon"
    href="{{ '/assets/logos/cropped-logo_cool-32x32.png' | relative_url }}"
    type="image/png"
  />

  <!-- Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Source+Serif+4:wght@400;700&display=swap"
    rel="stylesheet"
  />

  <!-- Styles -->
  <link
    rel="stylesheet"
    href="{{ '/assets/css/style.css' | relative_url }}"
  />

  <!-- NGL Viewer -->
  <script src="https://cdn.jsdelivr.net/npm/ngl@0.10.4/dist/ngl.js"></script>
  <script
    src="{{ '/assets/js/molecular-viewer.js' | relative_url }}"
    type="module"
  ></script>
</head>

<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <header>
    <div class="site-header">
      <!-- Site title + logo -->
      <h1 class="site-title">
        <a href="{{ '/' | relative_url }}">
          {{ site.title }}
          <img
            src="{{ '/assets/logos/cropped-logo_cool-180x180.png' | relative_url }}"
            alt="Lab logo"
            class="lab-logo"
          />
        </a>
      </h1>

      <!-- Navigation -->
      <nav aria-label="Main site navigation">
        <ul class="nav-links">
          <li><a href="{{ '/' | relative_url }}">Home</a></li>
          <li><a href="{{ '/team/' | relative_url }}">Team</a></li>

          <li>
            <a href="{{ '/research/' | relative_url }}">Research</a>
            <ul class="dropdown">
              <li><a href="{{ '/research/nuclear-mechanotransduction/' | relative_url }}">Nuclear Mechanotransduction</a></li>
              <li><a href="{{ '/research/microbiome/' | relative_url }}">Microbiome</a></li>
              <li><a href="{{ '/research/ai/' | relative_url }}">Artificial Intelligence</a></li>
            </ul>
          </li>

          <li>
            <a href="{{ '/publications/' | relative_url }}">Publications</a>
            <ul class="dropdown">
              <li><a href="{{ '/publications/journals/' | relative_url }}">Journal Articles</a></li>
              <li><a href="{{ '/publications/books/' | relative_url }}">Books</a></li>
            </ul>
          </li>

          <li><a href="{{ '/teaching/' | relative_url }}">Teaching</a></li>
          <li><a href="{{ '/news/' | relative_url }}">News</a></li>
          <li><a href="{{ '/contact/' | relative_url }}">Contact</a></li>
        </ul>
      </nav>

      <!-- Theme toggle -->
      <button
        id="theme-toggle"
        aria-label="Toggle light and dark mode"
        title="Toggle light/dark mode"
      >
        <span id="theme-icon" aria-hidden="true">ðŸŒ™</span>
      </button>
    </div>
  </header>

  <main id="main-content">
    {{ content }}
  </main>

  <!-- Theme toggle script -->
  <script>
    const htmlEl = document.documentElement;
    const toggle = document.getElementById('theme-toggle');
    const icon = document.getElementById('theme-icon');

    function setTheme(theme) {
      htmlEl.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      icon.textContent = theme === 'dark' ? 'ðŸŒ™' : 'â˜€ï¸';
    }

    // Initialize theme on page load
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
      setTheme(savedTheme);
    } else {
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      setTheme(prefersDark ? 'dark' : 'light');
    }

    toggle.addEventListener('click', () => {
      const current = htmlEl.getAttribute('data-theme');
      const next = current === 'dark' ? 'light' : 'dark';
      setTheme(next);
      window.dispatchEvent(new CustomEvent('themeChanged', { detail: { theme: next } }));
    });
  </script>
</body>
</html>
